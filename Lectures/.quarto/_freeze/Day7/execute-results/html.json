{
  "hash": "a840b6b68b44a34b2ad4daccc69174f1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data wrangling with **dplyr**\"\ntitle-slide-attributes:\n  data-background-image: images/lake.jpg\n  data-background-size: contain\n  data-background-opacity: \"0.5\"\nsubtitle: \"STAT 220\"\nauthor: \"Bastola\"\nformat:\n  revealjs: \n    theme: [default, scss/main.scss]\n    slide_level: 2\n    slide-number: true\n    preview-links: auto\n    history: true\n    chalkboard: true\n    transition: slide\n    background-transition: fade    \n    touch: false\n    controls: true\n---\n\n\n\n\n\n\n## Boolean operators\n\nFor help, `?base::Logic`\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/07-transform-logical.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n[Source: *R for Data Science*, by Grolemund & Wickham]{.footer}\n\n\n## `rename()` \n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 3\n  city     size  pollution\n  <chr>    <chr>     <dbl>\n1 New York large      23.4\n2 London   large      22.2\n3 Doha     small      12.4\n4 Hongkong small      15.6\n5 Beijing  large     121  \n```\n\n\n:::\n:::\n\n\n\n\n\n## Mutating multiple columns at once: `mutate_*`\n\n<br>\n\n::: bq\n::: font60\n\n- variants of `mutate()` that are useful for mutating multiple columns at once\n  + `mutate_at()`, `mutate_if()`, `mutate_all()`, etc.\n- which columns get mutated depends on a predicate, can be:\n  + a function that returns TRUE/FALSE like `is.numeric()`\n  + variable names through `vars()`\n\n:::\n:::\n\n## Mutating multiple columns at once: `mutate_*`\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 3\n  city     size  amount\n  <chr>    <chr> <chr> \n1 NEW YORK LARGE 23.4  \n2 LONDON   LARGE 22.2  \n3 DOHA     SMALL 12.4  \n4 HONGKONG SMALL 15.6  \n5 BEIJING  LARGE 121   \n```\n\n\n:::\n:::\n\n\n\n## Mutating multiple columns at once: `mutate_*`\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 3\n  city     size  amount\n  <chr>    <chr>  <dbl>\n1 New York large     23\n2 London   large     22\n3 Doha     small     12\n4 Hongkong small     16\n5 Beijing  large    121\n```\n\n\n:::\n:::\n\n\n\n\n::: middle-align-xy\n\n## Selecting & renaming multiple columns\n\n::: bbb\n\n- `select_*()` & `rename_*()` are variants of `select()` and `rename()`\n- use like `mutate_*()` options on previous slide\n:::\n:::\n\n\n\n\n::: centered-content\n## <i class=\"fa fa-pencil-square-o\" style=\"font-size:48px;color:purple\"> Group Activity 1</i> {background=\"#ffdf9e\"}\n\n::: row\n::: left\n![](https://media.giphy.com/media/RKApDdwsQ6jkwd6RNn/giphy.gif)\n:::\n\n::: right\n\n::: lqt\n\n- Please clone the `ca7-yourusername` repository from  [Github](https://github.com/DataScienceSpring24)\n- Please do the problem 1 in the class activity for today\n- Submit to Gradescope on [moodle](https://moodle.carleton.edu/course/view.php?id=43692) when done!\n:::\n:::\n:::\n\npreserve636b2aa6a0b34136\n:::\n\n\n\n## Join types\n\n<br>\n\n<center>\n<img src=\"images/join_types.png\" width=\"90%\" height=\"70%\"> <br>\n</center>\n\n\n\n\n\n## Two-table verbs\n\n<br>\n\n::: bql\n::: font80\n\n- `inner_join()` - Merge two datasets. Exclude all unmatched rows.\n\n- `full_join()` - Merge two datasets. Keep all observations.\n\n- `left_join()` - Merge two datasets. Keep all observations from the origin table.\n\n- `right_join()` - Merge two datasets. Keep all observations from the destination table.\n\n- `anti_join()` - Drops all observations in origin that have a match in destination table.\n:::\n:::\n\n\n\n## Mutating Joins\n\n<br>\n\nDiffer in their behavior when a match is not found\n\n::: bql\n::: font80\n\n- `left_join()`\n    \n- `right_join()`\n    \n- `inner_join()`\n    \n- `full_join()`\n\n:::\n:::\n\n\n\n\n## *left_join()*\n\n::: font90\n\n\n\n::: {.cell}\n\n:::\n\n\n\n::: row\n::: left\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nTable: df1\n\n|  x|  y|\n|--:|--:|\n|  1|  2|\n|  2|  1|\n\n\n:::\n:::\n\n\n\n:::\n\n::: right\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nTable: df2\n\n|  x|   a|b  |\n|--:|---:|:--|\n|  3|  10|a  |\n|  1| 100|r  |\n\n\n:::\n:::\n\n\n\n:::\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|  x|  y|   a|b  |\n|--:|--:|---:|:--|\n|  1|  2| 100|r  |\n|  2|  1|  NA|NA |\n\n\n:::\n:::\n\n\n\n\n:::\n\n  \n## *right_join()*\n\n::: font90\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n::: row\n::: left\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nTable: df1\n\n|  x|  y|\n|--:|--:|\n|  1|  2|\n|  2|  1|\n\n\n:::\n:::\n\n\n\n:::\n\n::: right\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nTable: df2\n\n|  x|   a|b  |\n|--:|---:|:--|\n|  3|  10|a  |\n|  1| 100|r  |\n\n\n:::\n:::\n\n\n\n:::\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|  x|  y|   a|b  |\n|--:|--:|---:|:--|\n|  1|  2| 100|r  |\n|  3| NA|  10|a  |\n\n\n:::\n:::\n\n\n\n:::\n\n\n## *inner_join()*\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n::: row\n::: left\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nTable: df1\n\n|  x|  y|\n|--:|--:|\n|  1|  2|\n|  2|  1|\n\n\n:::\n:::\n\n\n\n:::\n\n::: right\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nTable: df2\n\n|  x|   a|b  |\n|--:|---:|:--|\n|  3|  10|a  |\n|  1| 100|r  |\n\n\n:::\n:::\n\n\n\n:::\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|  x|  y|   a|b  |\n|--:|--:|---:|:--|\n|  1|  2| 100|r  |\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n## Flights data\n\n\n\n::: {.cell}\n\n:::\n\n\n\n<br>\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 8\n   year month   day  hour origin dest  tailnum carrier\n  <int> <int> <int> <dbl> <chr>  <chr> <chr>   <chr>  \n1  2013     1     1     5 EWR    IAH   N14228  UA     \n2  2013     1     1     5 LGA    IAH   N24211  UA     \n3  2013     1     1     5 JFK    MIA   N619AA  AA     \n4  2013     1     1     5 JFK    BQN   N804JB  B6     \n5  2013     1     1     6 LGA    ATL   N668DN  DL     \n6  2013     1     1     5 EWR    ORD   N39463  UA     \n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n## Airline information\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 2\n  carrier name                    \n  <chr>   <chr>                   \n1 9E      Endeavor Air Inc.       \n2 AA      American Airlines Inc.  \n3 AS      Alaska Airlines Inc.    \n4 B6      JetBlue Airways         \n5 DL      Delta Air Lines Inc.    \n6 EV      ExpressJet Airlines Inc.\n```\n\n\n:::\n:::\n\n\n\n\n\n\n## *left_join()*\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 336,776 × 9\n    year month   day  hour origin dest  tailnum carrier name                    \n   <int> <int> <int> <dbl> <chr>  <chr> <chr>   <chr>   <chr>                   \n 1  2013     1     1     5 EWR    IAH   N14228  UA      United Air Lines Inc.   \n 2  2013     1     1     5 LGA    IAH   N24211  UA      United Air Lines Inc.   \n 3  2013     1     1     5 JFK    MIA   N619AA  AA      American Airlines Inc.  \n 4  2013     1     1     5 JFK    BQN   N804JB  B6      JetBlue Airways         \n 5  2013     1     1     6 LGA    ATL   N668DN  DL      Delta Air Lines Inc.    \n 6  2013     1     1     5 EWR    ORD   N39463  UA      United Air Lines Inc.   \n 7  2013     1     1     6 EWR    FLL   N516JB  B6      JetBlue Airways         \n 8  2013     1     1     6 LGA    IAD   N829AS  EV      ExpressJet Airlines Inc.\n 9  2013     1     1     6 JFK    MCO   N593JB  B6      JetBlue Airways         \n10  2013     1     1     6 LGA    ORD   N3ALAA  AA      American Airlines Inc.  \n# ℹ 336,766 more rows\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n## Planes information\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 9\n  tailnum  year type               manufacturer model engines seats speed engine\n  <chr>   <int> <chr>              <chr>        <chr>   <int> <int> <int> <chr> \n1 N10156   2004 Fixed wing multi … EMBRAER      EMB-…       2    55    NA Turbo…\n2 N102UW   1998 Fixed wing multi … AIRBUS INDU… A320…       2   182    NA Turbo…\n3 N103US   1999 Fixed wing multi … AIRBUS INDU… A320…       2   182    NA Turbo…\n4 N104UW   1999 Fixed wing multi … AIRBUS INDU… A320…       2   182    NA Turbo…\n5 N10575   2002 Fixed wing multi … EMBRAER      EMB-…       2    55    NA Turbo…\n6 N105UW   1999 Fixed wing multi … AIRBUS INDU… A320…       2   182    NA Turbo…\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n## Keys: controlling how the tables are matched\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 336,776 × 16\n   year.x month   day  hour origin dest  tailnum carrier year.y type            \n    <int> <int> <int> <dbl> <chr>  <chr> <chr>   <chr>    <int> <chr>           \n 1   2013     1     1     5 EWR    IAH   N14228  UA        1999 Fixed wing mult…\n 2   2013     1     1     5 LGA    IAH   N24211  UA        1998 Fixed wing mult…\n 3   2013     1     1     5 JFK    MIA   N619AA  AA        1990 Fixed wing mult…\n 4   2013     1     1     5 JFK    BQN   N804JB  B6        2012 Fixed wing mult…\n 5   2013     1     1     6 LGA    ATL   N668DN  DL        1991 Fixed wing mult…\n 6   2013     1     1     5 EWR    ORD   N39463  UA        2012 Fixed wing mult…\n 7   2013     1     1     6 EWR    FLL   N516JB  B6        2000 Fixed wing mult…\n 8   2013     1     1     6 LGA    IAD   N829AS  EV        1998 Fixed wing mult…\n 9   2013     1     1     6 JFK    MCO   N593JB  B6        2004 Fixed wing mult…\n10   2013     1     1     6 LGA    ORD   N3ALAA  AA          NA <NA>            \n# ℹ 336,766 more rows\n# ℹ 6 more variables: manufacturer <chr>, model <chr>, engines <int>,\n#   seats <int>, speed <int>, engine <chr>\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n## Airport information\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 8\n  faa   name                             lat   lon   alt    tz dst   tzone      \n  <chr> <chr>                          <dbl> <dbl> <dbl> <dbl> <chr> <chr>      \n1 04G   Lansdowne Airport               41.1 -80.6  1044    -5 A     America/Ne…\n2 06A   Moton Field Municipal Airport   32.5 -85.7   264    -6 A     America/Ch…\n3 06C   Schaumburg Regional             42.0 -88.1   801    -6 A     America/Ch…\n4 06N   Randall Airport                 41.4 -74.4   523    -5 A     America/Ne…\n5 09J   Jekyll Island Airport           31.1 -81.4    11    -5 A     America/Ne…\n6 0A9   Elizabethton Municipal Airport  36.4 -82.2  1593    -5 A     America/Ne…\n```\n\n\n:::\n:::\n\n\n\n\n## Matching keys\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 336,776 × 15\n    year month   day  hour origin dest  tailnum carrier name     lat   lon   alt\n   <int> <int> <int> <dbl> <chr>  <chr> <chr>   <chr>   <chr>  <dbl> <dbl> <dbl>\n 1  2013     1     1     5 EWR    IAH   N14228  UA      Newar…  40.7 -74.2    18\n 2  2013     1     1     5 LGA    IAH   N24211  UA      La Gu…  40.8 -73.9    22\n 3  2013     1     1     5 JFK    MIA   N619AA  AA      John …  40.6 -73.8    13\n 4  2013     1     1     5 JFK    BQN   N804JB  B6      John …  40.6 -73.8    13\n 5  2013     1     1     6 LGA    ATL   N668DN  DL      La Gu…  40.8 -73.9    22\n 6  2013     1     1     5 EWR    ORD   N39463  UA      Newar…  40.7 -74.2    18\n 7  2013     1     1     6 EWR    FLL   N516JB  B6      Newar…  40.7 -74.2    18\n 8  2013     1     1     6 LGA    IAD   N829AS  EV      La Gu…  40.8 -73.9    22\n 9  2013     1     1     6 JFK    MCO   N593JB  B6      John …  40.6 -73.8    13\n10  2013     1     1     6 LGA    ORD   N3ALAA  AA      La Gu…  40.8 -73.9    22\n# ℹ 336,766 more rows\n# ℹ 3 more variables: tz <dbl>, dst <chr>, tzone <chr>\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n  \n## Filtering joins\n\nMost useful for diagnosing join mismatches\n\n::: eqt\n\nFiltering joins return a copy of the dataset that has been filtered, not augmented (as with mutating joins)\n\n- `semi_join(x,y)` :  keeps all observations in x that have a match in y.\n- `anti_join(x,y)` :  drops all observations in x that have a match in y.\n\n\n:::\n\n\n\n\n\n## Another example: *semi_join()*\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n::: font70\n::: row\n::: left\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nTable: df1\n\n|  x|  y|\n|--:|--:|\n|  1|  1|\n|  1|  2|\n|  3|  3|\n|  4|  4|\n\n\n:::\n:::\n\n\n\n:::\n\n\n::: right\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nTable: df2\n\n|  x|z  |\n|--:|:--|\n|  1|a  |\n|  1|b  |\n|  2|a  |\n\n\n:::\n:::\n\n\n\n:::\n:::\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|  x|  y|\n|--:|--:|\n|  1|  1|\n|  1|  2|\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n## Another example: *anti_join()*\n\n::: font70\n::: row\n::: left\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nTable: df1\n\n|  x|  y|\n|--:|--:|\n|  1|  1|\n|  1|  2|\n|  3|  3|\n|  4|  4|\n\n\n:::\n:::\n\n\n\n:::\n\n::: right\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nTable: df2\n\n|  x|z  |\n|--:|:--|\n|  1|a  |\n|  1|b  |\n|  2|a  |\n\n\n:::\n:::\n\n\n\n:::\n:::\n:::\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|  x|  y|\n|--:|--:|\n|  3|  3|\n|  4|  4|\n\n\n:::\n:::\n\n\n\n\n\n\n## Set Operations\n\nThese expect the x and y inputs to have the same variables, and treat the observations like sets:\n\n::: cle\n::: font70\n- `intersect(x,y)`\n  - will return only the rows that appear in both datasets\n- `union(x,y)` \n  - return every row that appears in one or more of the datasets\n  - If a row appears multiple times union will only return it once\n- `setdiff(x,y)`\n  - will return the rows that appear in the first dataset but not the second\n  \n:::\n:::\n\n\n## Set operations\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n::: row\n::: left\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nTable: df1\n\n|  x|  y|\n|--:|--:|\n|  1|  1|\n|  2|  1|\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nTable: df2\n\n|  x|  y|\n|--:|--:|\n|  1|  1|\n|  2|  2|\n\n\n:::\n:::\n\n\n\n:::\n\n::: right\n::: font80\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|  x|  y|\n|--:|--:|\n|  1|  1|\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|  x|  y|\n|--:|--:|\n|  2|  1|\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|  x|  y|\n|--:|--:|\n|  1|  1|\n|  2|  1|\n|  2|  2|\n\n\n:::\n:::\n\n\n\n:::\n:::\n:::\n\n\n\n\n::: centered-content\n## <i class=\"fa fa-pencil-square-o\" style=\"font-size:48px;color:purple\"> Group Activity 2</i> {background=\"#ffdf9e\"}\n\n::: row\n::: left\n![](https://media.giphy.com/media/RKApDdwsQ6jkwd6RNn/giphy.gif)\n:::\n\n::: right\n\n<br>\n\n::: lqt\n\n- Please do the remaining problems in the class activity.\n- Submit to Gradescope on [moodle](https://moodle.carleton.edu/course/view.php?id=43692) when done!\n:::\n:::\n:::\n\npreserveaec66a06a6338443\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"Day7_files/libs/countdown/countdown.css\" rel=\"stylesheet\" />\n<script src=\"Day7_files/libs/countdown/countdown.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {
      "preserve636b2aa6a0b34136": "<div class=\"countdown\" id=\"timer_f6ccb31a\" data-update-every=\"1\" tabindex=\"0\" style=\"top:0;left:0;padding:3px 4px;font-size:1em;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">10</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>",
      "preserveaec66a06a6338443": "<div class=\"countdown\" id=\"timer_985d90cd\" data-update-every=\"1\" tabindex=\"0\" style=\"top:0;left:0;padding:3px 4px;font-size:1em;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">10</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>"
    },
    "postProcess": true
  }
}