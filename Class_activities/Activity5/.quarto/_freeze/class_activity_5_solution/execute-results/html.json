{
  "hash": "d324533d2e75df7d5beed993abca1719",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Class Activity 5\"\nauthor: \"Your name here\"\ndate: \" April 02 2024\"\noutput: pdf_document\n---\n\n\n\n\n\n\n\n## Problem 1: Changing color and scales\n\nIn this problem, you will learn about the effects of changing colors, scales, and shapes in `ggplot2` for both gradient and discrete color choices. You will be given a series of questions and examples to enhance your understanding. Consider the following scatter plot\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Generate sample data\nset.seed(42)\ndata <- data.frame(\n  Category = factor(sample(1:3, 50, replace = TRUE), labels = c(\"A\", \"B\", \"C\")),\n  X = 10 ^ rnorm(50, mean = 2, sd = 1),\n  Y = rnorm(50, mean = 0, sd = 1)\n)\n\np <- ggplot(data, aes(x = X, y = Y, color = Category)) +\n  geom_point(size = 3)\n\np\n```\n\n::: {.cell-output-display}\n![](class_activity_5_solution_files/figure-html/unnamed-chunk-1-1.png){fig-align='center' width=480}\n:::\n:::\n\n\n\na. Modify the scatter plot to use custom colors for each category using `scale_color_manual()`. What is the effect of changing the colors on the plot's readability?\n\n*Answer:* Changing colors using `scale_color_manual()` allows for better distinction between categories and enhances the plot's readability.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np <- ggplot(data, aes(x = X, y = Y, color = Category)) +\n  geom_point(size = 3) +\n  scale_color_manual(values = c(\"red\", \"blue\", \"green\"))\np\n```\n\n::: {.cell-output-display}\n![](class_activity_5_solution_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=480}\n:::\n:::\n\n\n\n\n\nb. Modify the scatter plot to use custom shapes for each category using `scale_shape_manual()`. What is the effect of changing the shapes on the plot's readability?\n\n*Answer:*  Changing the shapes using scale_shape_manual() helps to distinguish between categories and improves the plot's readability\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np <- ggplot(data, aes(x = X, y = Y, shape = Category,  color = Category)) +\n  geom_point(size = 3) +\n  scale_shape_manual(values = c(\"A\" = 16, \"B\" = 17, \"C\" = 18)) +\n  scale_color_manual(values = c(\"A\" = \"red\", \"B\" = \"blue\", \"C\" = \"green\"))\n\np\n```\n\n::: {.cell-output-display}\n![](class_activity_5_solution_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=480}\n:::\n:::\n\n\n\n\nc. Try modifying the plot by combining color, shape, and theme customization. Additionally, try using `geom_smooth()` to add trend lines for each category. Pay attention to how each element affects the overall readability and interpretability of the plot.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np <- ggplot(data, aes(x = X, y = Y)) +\n  geom_point(aes(color = Category, shape = Category), size = 3) \n  geom_smooth(aes(group = Category, color = Category), method = \"lm\", se = FALSE) + \n  scale_shape_manual(values = c(\"A\" = 19, \"B\" = 8, \"C\" = 24)) + \n  scale_color_brewer(palette = \"Dark2\") + \n  ggthemes::theme_tufte() + \n  labs(title = \"Separate Trend Lines for Each Category\")\n## Error:\n## ! Cannot add <ggproto> objects together\n## â„¹ Did you forget to add this object to a <ggplot> object?\n\np\n```\n\n::: {.cell-output-display}\n![](class_activity_5_solution_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=480}\n:::\n:::\n\n\n\n\n\n# Problem 2: Chloropeth map\n\nIn today's class we created `cloropleth` maps of states in the US based on ACS data. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nstates <- map_data(\"state\")\nACS <- read.csv(\"https://raw.githubusercontent.com/deepbas/statdatasets/main/ACS.csv\")\nACS <- dplyr::filter(ACS, !(region  %in% c(\"Alaska\", \"Hawaii\"))) # only 48+D.C.\nACS$region <- tolower(ACS$region)  # lower case (match states regions)\n```\n:::\n\n\n\n### (a) Mapping median income\n\nCreate a `cloropleth` plot that uses color to create a `MedianIncome`  map of the US.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# map median income\nggplot(data=ACS) + coord_map() + \n  geom_map(aes(map_id = region, fill = MedianIncome), map = states) +\n  expand_limits(x=states$long, y=states$lat) + ggtitle(\"Median Income\")\n```\n\n::: {.cell-output-display}\n![](class_activity_5_solution_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=480}\n:::\n:::\n\n\n\n### (b) Mapping deviations from national median income\n\nThe median income in the US in 2016 was estimated to be $27,000. Redraw your map in (a) to visualize each state's deviation from national median income. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# compare state income to national income\nggplot(data=ACS) + coord_map() + \n  geom_map(aes(map_id = region, fill = MedianIncome - 27000), map = states) +\n  expand_limits(x=states$long, y=states$lat) + ggtitle(\"Deviation from national median income\")\n```\n\n::: {.cell-output-display}\n![](class_activity_5_solution_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=480}\n:::\n:::\n\n\n\n### (c) Changing numerically scaled color\n\nYou should use a *diverging* color for (b) to highlight larger deviations from the national median. Add `scale_fill_distiller` to the map from (b) and select a diverging palette.   \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# change to a diverging color\nggplot(data=ACS) + coord_map() + \n  geom_map(aes(map_id = region, fill = MedianIncome - 27000), map = states) +\n  expand_limits(x=states$long, y=states$lat) + ggtitle(\"Deviation from national median income\") + \n  scale_fill_distiller(type = \"div\")\n```\n\n::: {.cell-output-display}\n![](class_activity_5_solution_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=480}\n:::\n:::\n\n\n\n### (d) Fixing a midpoint on a diverging scale\n\nUse `scale_fill_gradient2` to fix a midpoint scale value at a white color, with diverging colors for larger positive and negative values. Apply this color to your map in (b) and fix the `midpoint` at an appropriate value. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# change to a gradient fill color\nggplot(data=ACS) + coord_map() + \n  geom_map(aes(map_id = region, fill = MedianIncome - 27000), map = states) +\n  expand_limits(x=states$long, y=states$lat) + ggtitle(\"Deviation from national median income\") + \n  scale_fill_gradient2(midpoint = 0)\n```\n\n::: {.cell-output-display}\n![](class_activity_5_solution_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=480}\n:::\n:::\n\n\n\n\n\nNext, we will use this merged data to create a polygon map that focuses on the boundaries and shapes of each state, colored by median income.\n\n### (e) Polygon map\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Merge income data with geographic information\nincome_data <- left_join(states, ACS, by = c(\"region\" = \"region\"))\n```\n:::\n\n\n\n\nFor this task, you will create a polygon map to visualize the `MedianIncome` across different states using the. Pay attention to the shapes and sizes of states as depicted on the map.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(sf)\n\nggplot(data = income_data) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = MedianIncome), \n               color = \"white\", size = 0.2) +\n  coord_sf(datum = NA) +\n  labs(fill = \"Median Income\", title = \"Median Income by State\") +\n  theme_minimal() +\n  scale_fill_viridis_c()\n```\n\n::: {.cell-output-display}\n![](class_activity_5_solution_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=480}\n:::\n:::\n\n\n\n\n### (f) Visualizing Relative Income Deviation \n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Calculate income deviation as a percentage\nnational_median <- 27000\n\n# Merge the updated income data with geographic information\nACS$IncomeDeviationPercent <- ((ACS$MedianIncome - national_median) / national_median) * 100\nincome_data <- left_join(states, ACS, by = c(\"region\" = \"region\"))\n\n# Plot the income deviation using Robinson projection with geom_polygon\nggplot(data = income_data) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = IncomeDeviationPercent), \n               color = \"white\", size = 0.2) +\n  coord_sf(datum = NA) +\n  labs(fill = \"Income Deviation (%)\", title = \"Income Deviation from National Median by State (%)\") +\n  theme_minimal() +\n  scale_fill_distiller(palette = \"Spectral\", name = \"Deviation (%)\")\n```\n\n::: {.cell-output-display}\n![](class_activity_5_solution_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=480}\n:::\n:::\n",
    "supporting": [
      "class_activity_5_solution_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}